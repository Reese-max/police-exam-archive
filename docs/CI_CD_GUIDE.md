# CI/CD èˆ‡æ¶µè“‹ç‡ä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. æŸ¥çœ‹æœ¬åœ°æ¶µè“‹ç‡

```bash
# åŸ·è¡Œæ¸¬è©¦ä¸¦ç”Ÿæˆæ¶µè“‹ç‡å ±å‘Š
pytest tests/ --cov=. --cov-report=html --cov-report=term

# é–‹å•Ÿ HTML å ±å‘Šï¼ˆWindowsï¼‰
start htmlcov\index.html
```

### 2. GitHub Actions CI/CD

#### å•Ÿç”¨æ–¹å¼
1. å°‡å°ˆæ¡ˆæ¨é€è‡³ GitHub
2. GitHub Actions æœƒè‡ªå‹•åµæ¸¬ `.github/workflows/ci.yml`
3. æ¯æ¬¡ push æˆ– PR æ™‚è‡ªå‹•åŸ·è¡Œæ¸¬è©¦

#### è§¸ç™¼æ¢ä»¶
- âœ… Push è‡³ `main`, `master`, `develop` åˆ†æ”¯
- âœ… æäº¤ Pull Request
- âœ… æ‰‹å‹•è§¸ç™¼ï¼ˆworkflow_dispatchï¼‰

#### åŸ·è¡Œå…§å®¹
1. **æ¸¬è©¦ä»»å‹™** (8 ç¨®ç’°å¢ƒçµ„åˆ)
   - OS: Ubuntu + Windows
   - Python: 3.10, 3.11, 3.12, 3.13
   - åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
   - ç”Ÿæˆæ¶µè“‹ç‡å ±å‘Š

2. **ç¨‹å¼ç¢¼é¢¨æ ¼æª¢æŸ¥**
   - Flake8 èªæ³•æª¢æŸ¥
   - ä¸æœƒä¸­æ–·å»ºç½®ï¼ˆcontinue-on-errorï¼‰

3. **æ¶µè“‹ç‡ä¸Šå‚³**
   - ä¸Šå‚³è‡³ Codecovï¼ˆéœ€è¨­å®š tokenï¼‰
   - å„²å­˜ç‚º GitHub Artifactsï¼ˆ30å¤©ï¼‰

---

## ğŸ“Š æ¶µè“‹ç‡å ±å‘Šè§£è®€

### ç•¶å‰ç‹€æ…‹ï¼ˆ2026-01-07ï¼‰

```
ç¸½é«”æ¶µè“‹ç‡: 68%

è©³ç´°åˆ†æ:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¨¡çµ„                â”‚ æ¶µè“‹ç‡ â”‚ ç‹€æ…‹     â”‚ å»ºè­°       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ auto_generate_form  â”‚  80%   â”‚ âœ… è‰¯å¥½  â”‚ è£œå……é‚Šç•Œ   â”‚
â”‚ è€ƒå¤é¡Œä¸‹è¼‰.py       â”‚  52%   â”‚ âš ï¸ ä¸­ç­‰  â”‚ æ–°å¢æ•´åˆæ¸¬è©¦â”‚
â”‚ smart_deploy.py     â”‚   0%   â”‚ âŒ æœªæ¸¬è©¦â”‚ å„ªå…ˆè™•ç†   â”‚
â”‚ tests/*             â”‚ 100%   â”‚ âœ… å®Œç¾  â”‚ ç¶­æŒ       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æœªæ¶µè“‹çš„é—œéµå‡½æ•¸

#### è€ƒå¤é¡Œä¸‹è¼‰.py (52% â†’ ç›®æ¨™ 75%)
```python
âŒ download_exam()          # ä¸»è¦ä¸‹è¼‰æµç¨‹
âŒ main()                   # ç¨‹å¼å…¥å£
âš ï¸ print_banner()           # UI é¡¯ç¤ºï¼ˆéƒ¨åˆ†æ¸¬è©¦ï¼‰
âš ï¸ confirm_settings()       # è¨­å®šç¢ºèªï¼ˆéƒ¨åˆ†æ¸¬è©¦ï¼‰
```

**å»ºè­°æ¸¬è©¦**:
```python
# tests/test_download_integration.py
def test_download_exam_success(mocker, tmp_path):
    """æ¸¬è©¦å®Œæ•´ä¸‹è¼‰æµç¨‹"""
    # Mock æ‰€æœ‰ç¶²è·¯è«‹æ±‚
    # é©—è­‰æª”æ¡ˆçµæ§‹æ­£ç¢ºå»ºç«‹
    # æª¢æŸ¥çµ±è¨ˆæ•¸æ“šæº–ç¢º

def test_main_with_user_input(mocker):
    """æ¸¬è©¦ä¸»ç¨‹å¼æµç¨‹"""
    # Mock æ‰€æœ‰ä½¿ç”¨è€…è¼¸å…¥
    # é©—è­‰å®Œæ•´åŸ·è¡Œè·¯å¾‘
```

#### smart_deploy.py (0% â†’ ç›®æ¨™ 50%)
```python
âŒ full_deploy()            # å®Œæ•´éƒ¨ç½²æµç¨‹
âŒ select_csv_files()       # CSV é¸æ“‡
âŒ run_cmd()                # å‘½ä»¤åŸ·è¡Œ
```

**å»ºè­°æ¸¬è©¦**:
```python
# tests/test_smart_deploy.py
def test_select_csv_files_returns_latest(mocker):
    """æ¸¬è©¦é¸æ“‡æœ€æ–° CSV"""
    
def test_run_cmd_success(mocker):
    """æ¸¬è©¦å‘½ä»¤åŸ·è¡ŒæˆåŠŸ"""
    
def test_full_deploy_integration(mocker):
    """æ¸¬è©¦å®Œæ•´éƒ¨ç½²æµç¨‹"""
```

---

## ğŸ¯ æ¶µè“‹ç‡æ”¹å–„è¨ˆåŠƒ

### Phase 1: çŸ­æœŸï¼ˆæœ¬é€±ï¼‰- ç›®æ¨™ 75%

**å„ªå…ˆç´š 1: smart_deploy.py åŸºç¤æ¸¬è©¦**
- [ ] æ–°å¢ `test_smart_deploy.py`
- [ ] æ¸¬è©¦ `run_cmd()` å‡½æ•¸
- [ ] æ¸¬è©¦ `select_csv_files()` å‡½æ•¸
- [ ] é æœŸæå‡: 0% â†’ 40%

**å„ªå…ˆç´š 2: è€ƒå¤é¡Œä¸‹è¼‰.py æ•´åˆæ¸¬è©¦**
- [ ] æ–°å¢ `test_download_integration.py`
- [ ] æ¸¬è©¦ `download_exam()` ä¸»æµç¨‹
- [ ] ä½¿ç”¨ responses æ¨¡æ“¬ HTTP
- [ ] é æœŸæå‡: 52% â†’ 70%

**é æœŸçµæœ**: 68% â†’ 75%

### Phase 2: ä¸­æœŸï¼ˆæœ¬æœˆï¼‰- ç›®æ¨™ 85%

**å„ªå…ˆç´š 3: End-to-End æ¸¬è©¦**
- [ ] æ–°å¢ `test_e2e.py`
- [ ] æ¸¬è©¦å®Œæ•´ä½¿ç”¨è€…æµç¨‹
- [ ] Mock æ‰€æœ‰å¤–éƒ¨ä¾è³´
- [ ] é æœŸæå‡: 75% â†’ 85%

**å„ªå…ˆç´š 4: éŒ¯èª¤æƒ…å¢ƒæ¸¬è©¦**
- [ ] ç¶²è·¯ä¸­æ–·è™•ç†
- [ ] ç£ç¢Ÿç©ºé–“ä¸è¶³
- [ ] æ¬Šé™éŒ¯èª¤æ¢å¾©
- [ ] é æœŸæå‡: 85% â†’ 88%

**é æœŸçµæœ**: 75% â†’ 88%

### Phase 3: é•·æœŸï¼ˆä¸‹å­£åº¦ï¼‰- ç›®æ¨™ 90%+

**å„ªå…ˆç´š 5: é‚Šç•Œæƒ…æ³**
- [ ] æ¥µç«¯å¤§æª”æ¡ˆ
- [ ] æ¥µç«¯é•·è·¯å¾‘
- [ ] Unicode é‚Šç•Œå­—å…ƒ
- [ ] é æœŸæå‡: 88% â†’ 92%

**é æœŸçµæœ**: 88% â†’ 92%

---

## ğŸ› ï¸ æœ¬åœ°é–‹ç™¼å·¥ä½œæµ

### 1. é–‹ç™¼æ–°åŠŸèƒ½
```bash
# å»ºç«‹åŠŸèƒ½åˆ†æ”¯
git checkout -b feature/new-feature

# é–‹ç™¼ + ç·¨å¯«æ¸¬è©¦
# ... (ç·¨è¼¯ç¨‹å¼ç¢¼å’Œæ¸¬è©¦)

# åŸ·è¡Œæ¸¬è©¦
pytest tests/ -v

# æª¢æŸ¥æ¶µè“‹ç‡
pytest tests/ --cov=. --cov-report=term
```

### 2. æäº¤å‰æª¢æŸ¥
```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
pytest tests/ -v

# æª¢æŸ¥æ¶µè“‹ç‡æ˜¯å¦ä¸‹é™
pytest tests/ --cov=. --cov-report=term

# èªæ³•æª¢æŸ¥ï¼ˆå¯é¸ï¼‰
flake8 . --max-line-length=127

# æäº¤
git add .
git commit -m "æè¿°"
git push
```

### 3. æŸ¥çœ‹ CI çµæœ
1. å‰å¾€ GitHub Actions é é¢
2. æŸ¥çœ‹æœ€æ–° workflow run
3. ä¸‹è¼‰ Artifacts ä¸­çš„æ¶µè“‹ç‡å ±å‘Š
4. æª¢æŸ¥ Codecov è©³ç´°å ±å‘Š

---

## ğŸ“¦ Codecov è¨­å®šï¼ˆå¯é¸ï¼‰

### 1. è¨»å†Š Codecov
1. å‰å¾€ https://codecov.io
2. ä½¿ç”¨ GitHub å¸³è™Ÿç™»å…¥
3. å•Ÿç”¨æ­¤å„²å­˜åº«

### 2. å–å¾— Token
1. åœ¨ Codecov å„²å­˜åº«è¨­å®šä¸­æ‰¾åˆ° token
2. åœ¨ GitHub å„²å­˜åº«è¨­å®šä¸­æ–°å¢ Secret:
   - Name: `CODECOV_TOKEN`
   - Value: (å¾ Codecov è¤‡è£½)

### 3. æ›´æ–° README badge
```markdown
[![codecov](https://codecov.io/gh/YOUR_USERNAME/YOUR_REPO/branch/master/graph/badge.svg)](https://codecov.io/gh/YOUR_USERNAME/YOUR_REPO)
```

---

## ğŸ”§ ç–‘é›£æ’è§£

### å•é¡Œ 1: æ¶µè“‹ç‡å ±å‘Šä¸æ­£ç¢º
```bash
# æ¸…é™¤èˆŠçš„ .coverage æª”æ¡ˆ
rm .coverage

# é‡æ–°åŸ·è¡Œ
pytest tests/ --cov=. --cov-report=html
```

### å•é¡Œ 2: GitHub Actions å¤±æ•—
```bash
# æœ¬åœ°æ¸¬è©¦ CI ç’°å¢ƒ
pytest tests/ --cov=. --cov-report=xml -v

# æª¢æŸ¥ requirements.txt æ˜¯å¦å®Œæ•´
pip install -r requirements.txt
```

### å•é¡Œ 3: æ¶µè“‹ç‡é¡¯ç¤ºéä½
```bash
# æª¢æŸ¥ pyproject.toml çš„ omit è¨­å®š
# ç¢ºä¿æ²’æœ‰èª¤æ’é™¤é‡è¦æª”æ¡ˆ
```

---

## ğŸ“š ç›¸é—œè³‡æº

- [pytest å®˜æ–¹æ–‡æª”](https://docs.pytest.org/)
- [pytest-cov æ–‡æª”](https://pytest-cov.readthedocs.io/)
- [GitHub Actions æ–‡æª”](https://docs.github.com/en/actions)
- [Codecov æ–‡æª”](https://docs.codecov.com/)

---

**æœ€å¾Œæ›´æ–°**: 2026-01-07  
**ç¶­è­·è€…**: å°ˆæ¡ˆåœ˜éšŠ  
**å•é¡Œå›å ±**: GitHub Issues
